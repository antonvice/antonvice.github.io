# How I made a Cocktail Recommendation App Using Machine Learning with Python, Streamlit, Airtable…

*Published on November 22, 2022*

## How I made a Cocktail Recommendation App Using Machine Learning with Python, Streamlit, Airtable, and GPT-3.    ## Part 1 — The Intro    ![](https://cdn-images-1.medium.com/max/800/1*ZbeCjNhVjnMiiOprr_ZsXg.png)    I was at a bar trying to discover new combinations of flavors that I could enjoy, but it was rather difficult to rely on the bartender’s guess since I only have two or three drinks to try before heading home. What if I don’t enjoy them? I have to be very careful in picking the drinks to spend the night pleasantly. This got me thinking, what if there was a way to find cocktails that I could enjoy with the flavors I already know I enjoy?    I decided to create a cocktail recommendation app using machine learning that would take in a list of features of a cocktail that I enjoy and recommend cocktails that could increase the likelihood of me enjoying them.    My original idea is to cluster the cocktails based on the ingredients and some engineered features such as the presence of liqueur, then create an arbitrary cocktail with selected features that the user enjoys, and classify it to the cluster of most related cocktails to further spit up the cocktails from that cluster as recommendations.    ## Part 2 — The Dataset    To create this app, I first needed to find a dataset of cocktails and their ingredients. I found a great dataset on Kaggle that contained over 600 cocktails and their ingredients.    ![](https://cdn-images-1.medium.com/max/600/1*Z_8RU2f1lVoGYpHU5m-H8Q.png)    ![https://www.kaggle.com/datasets/shuyangli94/cocktails-hotaling-co](https://cdn-images-1.medium.com/max/600/1*nsu5Ay0GYdsCTbusIapMUw.png)  *https://www.kaggle.com/datasets/shuyangli94/cocktails-hotaling-co*    The dataset turned out to be quite informative as it contained the ingredients and preparation instructions for the cocktails which would simplify the job for the bartender as well as give me an idea about how to approach the problem.    As you can see there are quite a few missing values for the names of the cocktails, but that is not important as long as we have the ingredients and IDs for the items.    I will be using GPT-3 to generate the names of missing names of the cocktails    ![filling in the missing values for the future](https://cdn-images-1.medium.com/max/800/1*_taYQeYLr-XSnbxTIjaQ0Q.png)  *filling in the missing values for the future*    Next, I created a list of ingredients that make up flavor profiles and assigned a boolean for the flavor to each cocktail    ![](https://cdn-images-1.medium.com/max/800/1*JcS6ssKIB27THvsfk414Nw.png)    ![](https://cdn-images-1.medium.com/max/800/1*RB13Ga2njzTSCy78syTQtw.png)    ![](https://cdn-images-1.medium.com/max/800/1*gfOikkEKKqyBySL4-p_QLw.png)    ![](https://cdn-images-1.medium.com/max/800/1*OhYpG34TQf6h4i_i1GR69g.png)    Then I did the same thing for the base alcohol and the presence of liqueurs.    ![](https://cdn-images-1.medium.com/max/800/1*-2KtK1FFyABF3IgG2Eh55g.png)    Now I have a prepared dataset for my machine learning model and can upload it to airtable.    ![](https://cdn-images-1.medium.com/max/800/1*8ZRJFm_bwpKzs73-D2_AHQ.png)    ## Part 3 — The Algorithm    I will be training two algorithms on my dataset:    The reason I chose K-means is that it is an unsupervised method which means that I don’t need labeled data to train them. This is important because it would be very difficult to come up with arbitrary groupings for all 600+ cocktails by hand unless you base them on the base alcohol. Then the problem arises that we are limiting ourselves to only the drinks with the same alcohol but different taste profiles, which is not what we want. K-Means Clustering is a good choice for this problem because it groups similar objects together and we can use that to our advantage by finding groups of cocktails with similar ingredients which should theoretically taste similar as well.    After I come up with arbitrary clusters, I can use a simple k-nn algorithm to classify a new datapoint.    First, let’s select only the most important features to reduce dimensionality. To do that, I will be utilizing Principal Component Analysis (PCA) with 95% variance    ![Length of features list](https://cdn-images-1.medium.com/max/800/1*j3G3rKbhc28029hjdlCAJw.png)  *Length of features list*    And here is how many of these 19 features will come in useful with 95% variance:    ![12 components will do the trick](https://cdn-images-1.medium.com/max/800/1*EDCrftssJ8ECUnIiRkhYwQ.png)  *12 components will do the trick*    The next step is figuring out how well our clustering algorithm worked, for that, I will use an average silhouette coefficient of 0.55    ## Silhouette Coefficient:    The silhouette coefficient or silhouette score is a metric used to calculate the goodness of a clustering technique. Its value ranges from -1 to 1.    1: Means clusters are well apart from each other and clearly distinguished.    0: Means clusters are indifferent, or we can say that the distance between clusters is not significant.    -1: Means clusters are assigned in the wrong way.    ![49 clusters is what I am looking for](https://cdn-images-1.medium.com/max/800/1*PflrrdbgYBCQbuGaO3L8vw.png)  *49 clusters is what I am looking for*    Let’s analyze the cluster number 7 and see what is going on in there    ![](https://cdn-images-1.medium.com/max/600/1*g3fMmUaB3tdYZmS1PuriIw.png)    ![All of the cocktails seem to contain mostly Liqueurs and are sweet and sour. THIS WORKS FOR ME!](https://cdn-images-1.medium.com/max/600/1*UEBCnuWk_UQRgoA8qED65g.png)  *All of the cocktails seem to contain mostly Liqueurs and are sweet and sour. THIS WORKS FOR ME!*    In this part, we will be training different classification algorithms to see which one performs best.    ![MLP performs best](https://cdn-images-1.medium.com/max/800/1*KD9v4qNeLpWB6iGAOogVgg.png)  *MLP performs best*    ## Part 4 — Streamlit Layout    First of all, I created a project folder and initiated streamlit in pipenv:    Then, I created an app.py file and started with importing all the necessary libraries and setting up the page config:    Here you can see the pyairtable library for communicating with airtable database I created, scikit-learn for algorithm building, and openai library for the missing cocktail name generation.    This part of the code sets up the prompt for the cocktail name generation and pulls up the APIs that I will create during the deployment.    Now, lits define the main functions, they will be stored in cache to be used when called.    Let’s run the initialization and set up the title screen:    This is a simple streamlit layout to choose our features to be added to the main DataFrame for the training:    Our features will be of two sets — alcohol base and flavor profile.    ![I like absinthe drinks with sour notes](https://cdn-images-1.medium.com/max/800/1*ZbeCjNhVjnMiiOprr_ZsXg.png)  *I like absinthe drinks with sour notes*    I decided to leave the algorithm running online so you can see how it works:    ## Outro    The final step is to upload the repository to GitHub and deploy it to Streamlit.    To create a repository on Github:    Then, to bake the app with streamlit:    ![](https://cdn-images-1.medium.com/max/800/1*zOkNv7wIf4Ozpemc8BGQeA.png)    ![](https://cdn-images-1.medium.com/max/800/1*SGulER82m2_2hKWwFad52w.png)  

*By Anton [The AI Whisperer] Vice*
